{% extends 'base.html' %}
{% block title %}
  Possible Phishing Domains Page
{% endblock %}

{% block content %}
<h1 style="text-align: center; padding: 10px 0">Possible Phishing Domains</h1>

    <select style="padding: 5px 5px; margin-bottom: 10px; font-size: 18px; background-color: #212121; color: aliceblue; border-radius:5px" id="domain-types" onchange="change_domain_types()">
        <option style="background-color: #212121; color: aliceblue" id="All" value="All">Choose domain status</option>
        <option style="background-color: #212121; color: aliceblue" id="All" value="All">All Possible Phishing Domains</option>
        <option style="background-color: #212121; color: aliceblue" id="Approved" value="Approved">Approved</option>
        <option style="background-color: #212121; color: aliceblue" id="False Positive" value="False Positive">False Positive</option>
    </select>


    <table class="table table-hover table-dark" id="domains">
        <thead>
            <tr>
                <!-- Your Columns HERE -->
                <th scope="col">Phishing Domain</th>
                <th scope="col">User</th>
                <th scope="col">Keyword</th>
                <th scope="col">Insert Date</th>
                <th scope="col">Update Date</th>
                <th scope="col" style="text-align: center">False Positive</th>
                <th scope="col" style="text-align: center">Approved</th>
            </tr>
        </thead>
        <tbody id="table-content">
            <!-- Your rows inside the table HERE: -->
            {% for possible_phishing in possible_phishings %}
                <tr id="table-rows">
                    <td><a  href="http://{{ possible_phishing.possible_phishing_domain }}" style="color:white">{{ possible_phishing.possible_phishing_domain }}</a></td>
                    <td>{{ possible_phishing.register_name}}</td>
                    <td>{{ possible_phishing.from_which_keyword}}</td>
                    <td>{{ possible_phishing.insert_date}}</td>
                    <td>{{ possible_phishing.update_date}}</td>
                    <td style="text-align: center"><button onclick="change_status('{{ possible_phishing.possible_phishing_domain }}', 'false_positive')"
                                                           style="background-color:red; padding: 10px 10px"
                                                           type="button"></button></td>
                    <td style="text-align: center"><button onclick="change_status('{{ possible_phishing.possible_phishing_domain }}', 'approved')"
                                                           style="background-color:green; padding: 10px 10px"
                                                           type="button"></button></td> <!-- todo-->
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <script>
        function change_domain_types(){
            const select = document.getElementById("domain-types");
            const value = select.options[select.selectedIndex].value;
            window.location.href = `http://127.0.0.1:5000/possible_phishing_domains?value=${value}`;
        }

        function change_status(phishing_domain, status){
            window.location.href = `http://127.0.0.1:5000/possible_phishing_domains?phishing_domain=${phishing_domain}&?status=${status}`;
        }
    </script>
      
{% endblock %}